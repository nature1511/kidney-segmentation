<!DOCTYPE html>
<!-- saved from url=(0067)https://sgugger.github.io/how-do-you-find-a-good-learning-rate.html -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <link href="./Another data science student&#39;s blog – How Do You Find A Good Learning Rate_files/css" rel="stylesheet" type="text/css">

    <link rel="stylesheet" type="text/css" href="./Another data science student&#39;s blog – How Do You Find A Good Learning Rate_files/style.min.css">

  <link rel="stylesheet" type="text/css" href="./Another data science student&#39;s blog – How Do You Find A Good Learning Rate_files/github.min.css">
  <link rel="stylesheet" type="text/css" href="./Another data science student&#39;s blog – How Do You Find A Good Learning Rate_files/font-awesome.min.css">


    <link href="https://sgugger.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Another data science student&#39;s blog Atom">

    <link href="https://sgugger.github.io/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="Another data science student&#39;s blog RSS">


  
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="HandheldFriendly" content="True">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="robots" content="">


<meta name="author" content="Sylvain Gugger">
<meta name="description" content="This is the main hyper-parameter to set when we train a neural net, but how do you determine the best value? Here&#39;s a technique to quickly decide on one.">
<meta name="keywords" content="SGD, Learning Rate">
<meta property="og:site_name" content="Another data science student&#39;s blog">
<meta property="og:title" content="How Do You Find A Good Learning Rate">
<meta property="og:description" content="This is the main hyper-parameter to set when we train a neural net, but how do you determine the best value? Here&#39;s a technique to quickly decide on one.">
<meta property="og:locale" content="en_US">
<meta property="og:url" content="/how-do-you-find-a-good-learning-rate.html">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2018-03-20 16:15:00-04:00">
<meta property="article:modified_time" content="">
<meta property="article:author" content="/author/sylvain-gugger.html">
<meta property="article:section" content="Basics">
<meta property="article:tag" content="SGD">
<meta property="article:tag" content="Learning Rate">
<meta property="og:image" content="/images/profile.png">

  <title>Another data science student's blog – How Do You Find A Good Learning Rate</title>

<style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax_LineBox {display: table!important}
.MathJax_LineBox span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?V=2.7.0') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?V=2.7.0') format('opentype')}
@font-face {font-family: MathJax_Main-bold; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?V=2.7.0') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?V=2.7.0') format('opentype')}
@font-face {font-family: MathJax_Main-italic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?V=2.7.0') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?V=2.7.0') format('opentype')}
@font-face {font-family: MathJax_Math-italic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?V=2.7.0') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?V=2.7.0') format('opentype')}
@font-face {font-family: MathJax_Caligraphic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?V=2.7.0') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?V=2.7.0') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?V=2.7.0') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?V=2.7.0') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?V=2.7.0') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?V=2.7.0') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?V=2.7.0') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?V=2.7.0') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?V=2.7.0') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?V=2.7.0') format('opentype')}
.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn {color: inherit ! important}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>
<body><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>
  <aside>
    <div>
      <a href="https://sgugger.github.io/">
        <img src="./Another data science student&#39;s blog – How Do You Find A Good Learning Rate_files/profile.png" alt="Sylvain Gugger" title="Sylvain Gugger">
      </a>
      <h1><a href="https://sgugger.github.io/">Sylvain Gugger</a></h1>


      <nav>
        <ul class="list">
          <li><a href="https://sgugger.github.io/pages/about-me.html#about-me">About Me</a></li>

          <li><a href="http://fast.ai/" target="_blank">fast.ai</a></li>
        </ul>
      </nav>

      <ul class="social">
        <li><a class="sc-linkedin" href="https://www.linkedin.com/in/sylvain-gugger-74218b144/" target="_blank"><i class="fa fa-linkedin"></i></a></li>
        <li><a class="sc-github" href="https://github.com/sgugger" target="_blank"><i class="fa fa-github"></i></a></li>
        <li><a class="sc-twitter" href="https://twitter.com/GuggerSylvain" target="_blank"><i class="fa fa-twitter"></i></a></li>
      </ul>
    </div>


  </aside>
  <main>

    <nav>
      <a href="https://sgugger.github.io/">    Home
</a>

      <a href="https://sgugger.github.io/categories.html">Categories</a>
      <a href="https://sgugger.github.io/tags.html">Tags</a>
      <a href="https://sgugger.github.io/archives.html">Archives</a>

      <a href="https://sgugger.github.io/feeds/all.atom.xml">    Atom
</a>

      <a href="https://sgugger.github.io/feeds/all.rss.xml">    RSS
</a>
    </nav>

<article class="single">
  <header>
    <h1 id="how-do-you-find-a-good-learning-rate">How Do You Find A Good Learning Rate</h1>
    <p>
          Posted on Tue 20 March 2018 in <a href="https://sgugger.github.io/category/basics.html">Basics</a>


    </p>
  </header>


  <div>
    <div class="section" id="the-theory">
<h2>The theory</h2>
<p>How do you decide on a learning rate? If it's too slow, your neural net is going to take forever to learn (try to use <span class="math"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 2.246em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.973em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.207em, 1001.99em, 2.41em, -1000.02em); top: -2.241em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="msubsup" id="MathJax-Span-3"><span style="display: inline-block; position: relative; width: 1.973em; height: 0px;"><span style="position: absolute; clip: rect(3.177em, 1000.95em, 4.161em, -1000.02em); top: -3.992em; left: 0em;"><span class="mn" id="MathJax-Span-4" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.375em; left: 0.988em;"><span class="texatom" id="MathJax-Span-5"><span class="mrow" id="MathJax-Span-6"><span class="mo" id="MathJax-Span-7" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-8" style="font-size: 70.7%; font-family: MathJax_Main;">5</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.246em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.058em; border-left: 0px solid; width: 0px; height: 1.106em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>10</mn><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>5</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-1">10^{-5}</script></span> instead of <span class="math"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-9" style="width: 2.246em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.973em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.207em, 1001.99em, 2.41em, -1000.02em); top: -2.241em; left: 0em;"><span class="mrow" id="MathJax-Span-10"><span class="msubsup" id="MathJax-Span-11"><span style="display: inline-block; position: relative; width: 1.973em; height: 0px;"><span style="position: absolute; clip: rect(3.177em, 1000.95em, 4.161em, -1000.02em); top: -3.992em; left: 0em;"><span class="mn" id="MathJax-Span-12" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.375em; left: 0.988em;"><span class="texatom" id="MathJax-Span-13"><span class="mrow" id="MathJax-Span-14"><span class="mo" id="MathJax-Span-15" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-16" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.246em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.058em; border-left: 0px solid; width: 0px; height: 1.106em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>10</mn><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>2</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-2">10^{-2}</script></span> in
<a class="reference external" href="https://sgugger.github.io/a-neural-net-in-pytorch.html">the previous article</a> for instance). But if it's too high, each step you take will go over the minimum and you'll never get to an acceptable loss.
Worse, a high learning rate could lead you to an increasing loss until it reaches nan.</p>
<p>Why is that? If your gradients are really high, then a high learning rate is going to take you to a spot that's so far away from the minimum you will probably be worse than before
in terms of loss. Even on something as simple as a parabola, see how a high learning rate quickly gets you further and further away from the minima.</p>
<img alt="" class="align-center" src="./Another data science student&#39;s blog – How Do You Find A Good Learning Rate_files/art2_explode.png" style="width: 500px;">
<p>So we have to pick exactly the right value, not too high and not too low. For a long time, it's been a game of try and see, but in <a class="reference external" href="https://arxiv.org/abs/1506.01186">this article</a> another approach is presented. Over an epoch begin your SGD with a very low learning rate (like <span class="math"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;8&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-17" style="width: 2.246em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.973em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.207em, 1001.99em, 2.41em, -1000.02em); top: -2.241em; left: 0em;"><span class="mrow" id="MathJax-Span-18"><span class="msubsup" id="MathJax-Span-19"><span style="display: inline-block; position: relative; width: 1.973em; height: 0px;"><span style="position: absolute; clip: rect(3.177em, 1000.95em, 4.161em, -1000.02em); top: -3.992em; left: 0em;"><span class="mn" id="MathJax-Span-20" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.375em; left: 0.988em;"><span class="texatom" id="MathJax-Span-21"><span class="mrow" id="MathJax-Span-22"><span class="mo" id="MathJax-Span-23" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-24" style="font-size: 70.7%; font-family: MathJax_Main;">8</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.246em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.058em; border-left: 0px solid; width: 0px; height: 1.106em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>10</mn><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>8</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-3">10^{-8}</script></span>) but change it
(by multiplying it by a certain factor for instance)
at each mini-batch until it reaches a very high value (like 1 or 10). Record the loss each time at each iteration and once you're finished, plot those losses against the learning
rate. You'll find something like this:</p>
<img alt="Plot of the loss against the learning rate" class="align-center" src="./Another data science student&#39;s blog – How Do You Find A Good Learning Rate_files/art2_courbe_lr.png">
<p>The loss decreases at the beginning, then it stops and it goes back increasing, usually extremely quickly. That's because with very low learning rates, we get better and better,
especially since we increase them. Then comes a point where we reach a value that's too high and the phenomenon shown before happens. Looking at this graph, what is the best
learning rate to choose? Not the one corresponding to the minimum.</p>
<p>Why? Well the learning rate that corresponds to the minimum value is already a bit too high, since we are at the edge between improving and getting all over the place.
We want to go one order of magnitude before, a value that's still aggressive (so that we train quickly) but still on the safe side from an explosion. In the example described by
the picture above, for instance, we don't want to pick <span class="math"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-25" style="width: 2.246em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.973em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.207em, 1001.99em, 2.41em, -1000.02em); top: -2.241em; left: 0em;"><span class="mrow" id="MathJax-Span-26"><span class="msubsup" id="MathJax-Span-27"><span style="display: inline-block; position: relative; width: 1.973em; height: 0px;"><span style="position: absolute; clip: rect(3.177em, 1000.95em, 4.161em, -1000.02em); top: -3.992em; left: 0em;"><span class="mn" id="MathJax-Span-28" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.375em; left: 0.988em;"><span class="texatom" id="MathJax-Span-29"><span class="mrow" id="MathJax-Span-30"><span class="mo" id="MathJax-Span-31" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-32" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.246em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.058em; border-left: 0px solid; width: 0px; height: 1.106em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>10</mn><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-4">10^{-1}</script></span> but rather <span class="math"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-33" style="width: 2.246em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.973em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.207em, 1001.99em, 2.41em, -1000.02em); top: -2.241em; left: 0em;"><span class="mrow" id="MathJax-Span-34"><span class="msubsup" id="MathJax-Span-35"><span style="display: inline-block; position: relative; width: 1.973em; height: 0px;"><span style="position: absolute; clip: rect(3.177em, 1000.95em, 4.161em, -1000.02em); top: -3.992em; left: 0em;"><span class="mn" id="MathJax-Span-36" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.375em; left: 0.988em;"><span class="texatom" id="MathJax-Span-37"><span class="mrow" id="MathJax-Span-38"><span class="mo" id="MathJax-Span-39" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-40" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.246em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.058em; border-left: 0px solid; width: 0px; height: 1.106em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>10</mn><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>2</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-5">10^{-2}</script></span>.</p>
<p>This method can be applied on top of every variant of SGD, and any kind of network. We just have to go through one epoch (usually less) and record the values of our loss
to get the data for our plot.</p>
</div>
<div class="section" id="in-practice">
<h2>In practice</h2>
<p>How do we code this? Well it's pretty simple when we use the fastai library. As detailed in the <a class="reference external" href="http://course.fast.ai/lessons/lesson1.html">first lesson</a>, if we have built a learner object for our model, we just have
to type</p>
<pre class="code python literal-block"><span class="n">learner</span><span class="o">.</span><span class="n">lr_find</span><span class="p">()</span>
<span class="n">learner</span><span class="o">.</span><span class="n">sched</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre>
<p>and we'll get a picture very similar as then one above. Let's do it ourselves though, to be sure we have understood everything there is behind the scenes. It's going to be pretty
easy since we just have to adapt the training loop seen in <a class="reference external" href="https://sgugger.github.io/a-neural-net-in-pytorch.html">that article</a> there is just a few tweaks.</p>
<p>The first one is that we won't really plot the loss of each mini-batch, but some smoother version of it. If we tried to plot the raw loss, we would end up with a graph like
this one:</p>
<img alt="Plot of the loss against the learning rate" class="align-center" src="./Another data science student&#39;s blog – How Do You Find A Good Learning Rate_files/art2_loss_vs_lr.png">
<p>Even if we can see a global trend (and that's because I truncated the part where it goes up to infinity on the right), it's not as clear as the previous graph. To smooth those
losses we will take their exponentially weighed averages. It sounds far more complicated that it is and if you're familiar with the momentum variant of SGD it's exactly
the same. At each step where we get a loss, we define this average loss by</p>
<div class="math">
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;&gt;&lt;mtext&gt;avg loss&lt;/mtext&gt;&lt;/mstyle&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;&gt;&lt;mtext&gt;old avg loss&lt;/mtext&gt;&lt;/mstyle&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;&gt;&lt;mtext&gt;loss&lt;/mtext&gt;&lt;/mstyle&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-41" style="width: 20.085em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.896em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.316em, 1017.86em, 2.684em, -1000.02em); top: -2.241em; left: 0em;"><span class="mrow" id="MathJax-Span-42"><span class="mstyle" id="MathJax-Span-43"><span class="mrow" id="MathJax-Span-44"><span class="mtext" id="MathJax-Span-45" style="font-family: MathJax_Main;">avg loss</span></span></span><span class="mo" id="MathJax-Span-46" style="font-family: MathJax_Main; padding-left: 0.276em;">=</span><span class="mi" id="MathJax-Span-47" style="font-family: MathJax_Math-italic; padding-left: 0.276em;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-48" style="font-family: MathJax_Main; padding-left: 0.222em;">∗</span><span class="mstyle" id="MathJax-Span-49" style="padding-left: 0.222em;"><span class="mrow" id="MathJax-Span-50"><span class="mtext" id="MathJax-Span-51" style="font-family: MathJax_Main;">old avg loss</span></span></span><span class="mo" id="MathJax-Span-52" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mo" id="MathJax-Span-53" style="font-family: MathJax_Main; padding-left: 0.222em;">(</span><span class="mn" id="MathJax-Span-54" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-55" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-56" style="font-family: MathJax_Math-italic; padding-left: 0.222em;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-57" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-58" style="font-family: MathJax_Main; padding-left: 0.222em;">∗</span><span class="mstyle" id="MathJax-Span-59" style="padding-left: 0.222em;"><span class="mrow" id="MathJax-Span-60"><span class="mtext" id="MathJax-Span-61" style="font-family: MathJax_Main;">loss</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.246em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.365em; border-left: 0px solid; width: 0px; height: 1.229em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mstyle displaystyle="false" scriptlevel="0"><mtext>avg loss</mtext></mstyle><mo>=</mo><mi>β</mi><mo>∗</mo><mstyle displaystyle="false" scriptlevel="0"><mtext>old avg loss</mtext></mstyle><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>β</mi><mo stretchy="false">)</mo><mo>∗</mo><mstyle displaystyle="false" scriptlevel="0"><mtext>loss</mtext></mstyle></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-6">\begin{equation*}
\hbox{avg loss} = \beta * \hbox{old avg loss} + (1-\beta) * \hbox{loss}
\end{equation*}</script>
</div>
<p>where <span class="math"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-62" style="width: 0.605em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.55em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.371em, 1000.57em, 2.629em, -1000.02em); top: -2.241em; left: 0em;"><span class="mrow" id="MathJax-Span-63"><span class="mi" id="MathJax-Span-64" style="font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.246em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.303em; border-left: 0px solid; width: 0px; height: 1.106em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>β</mi></math></span></span><script type="math/tex" id="MathJax-Element-7">\beta</script></span> is a parameter we get to pick between 0 and 1. This way the average losses will reduce the noise and give us a smoother graph where we'll definitely be able to
see the trend. This also also explains why we are <em>too late</em> when we reach the minimum in our first curve: this averaged loss will stay low when our losses start to explode, and
it'll take a bit of time before it starts to really increase.</p>
<p>If you don't see the exponentially weighed behind this average, it's because it's hidden in our recursive formula. If our losses are <span class="math"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-65" style="width: 4.271em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.778em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.371em, 1003.8em, 2.629em, -1000.02em); top: -2.241em; left: 0em;"><span class="mrow" id="MathJax-Span-66"><span class="msubsup" id="MathJax-Span-67"><span style="display: inline-block; position: relative; width: 0.714em; height: 0px;"><span style="position: absolute; clip: rect(3.122em, 1000.29em, 4.161em, -1000.02em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-68" style="font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.276em;"><span class="texatom" id="MathJax-Span-69"><span class="mrow" id="MathJax-Span-70"><span class="mn" id="MathJax-Span-71" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-72" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-73" style="font-family: MathJax_Main; padding-left: 0.167em;">…</span><span class="mo" id="MathJax-Span-74" style="font-family: MathJax_Main; padding-left: 0.167em;">,</span><span class="msubsup" id="MathJax-Span-75" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.824em; height: 0px;"><span style="position: absolute; clip: rect(3.122em, 1000.29em, 4.161em, -1000.02em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-76" style="font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.276em;"><span class="texatom" id="MathJax-Span-77"><span class="mrow" id="MathJax-Span-78"><span class="mi" id="MathJax-Span-79" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.246em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.303em; border-left: 0px solid; width: 0px; height: 1.106em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-8">l_{0},\dots,l_{n}</script></span> then the
exponentially weighed loss at a given index <span class="math"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-80" style="width: 0.386em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.331em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.425em, 1000.29em, 2.41em, -1000.02em); top: -2.241em; left: 0em;"><span class="mrow" id="MathJax-Span-81"><span class="mi" id="MathJax-Span-82" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.246em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.058em; border-left: 0px solid; width: 0px; height: 0.861em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-9">i</script></span> is</p>
<div class="math">
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;&gt;&lt;mtext&gt;avg loss&lt;/mtext&gt;&lt;/mstyle&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;msub&gt;&lt;mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;&gt;&lt;mtext&gt;avg loss&lt;/mtext&gt;&lt;/mstyle&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;&gt;&lt;mtext&gt;avg loss&lt;/mtext&gt;&lt;/mstyle&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;&gt;&lt;mtext&gt;avg loss&lt;/mtext&gt;&lt;/mstyle&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;&amp;#x22EE;&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo&gt;&amp;#x22EF;&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-83" style="width: 34.914em; display: inline-block;"><span style="display: inline-block; position: relative; width: 31.139em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(-1.092em, 1030.99em, 5.092em, -1000.02em); top: -2.241em; left: 0em;"><span class="mrow" id="MathJax-Span-84"><span class="mtable" id="MathJax-Span-85" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 30.81em; height: 0px;"><span style="position: absolute; clip: rect(3.286em, 1003.69em, 9.086em, -1000.02em); top: -6.454em; left: 0em;"><span style="display: inline-block; position: relative; width: 3.669em; height: 0px;"><span style="position: absolute; clip: rect(3.122em, 1003.69em, 4.435em, -1000.02em); top: -6.29em; right: 0em;"><span class="mtd" id="MathJax-Span-86"><span class="mrow" id="MathJax-Span-87"><span class="msubsup" id="MathJax-Span-88"><span style="display: inline-block; position: relative; width: 3.669em; height: 0px;"><span style="position: absolute; clip: rect(3.122em, 1003.3em, 4.38em, -1000.02em); top: -3.992em; left: 0em;"><span class="mstyle" id="MathJax-Span-89"><span class="mrow" id="MathJax-Span-90"><span class="mtext" id="MathJax-Span-91" style="font-family: MathJax_Main;">avg loss</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.773em; left: 3.341em;"><span class="texatom" id="MathJax-Span-92"><span class="mrow" id="MathJax-Span-93"><span class="mi" id="MathJax-Span-94" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.833em, 1000.02em, 4.161em, -1000.02em); top: -4.813em; right: 0em;"><span class="mtd" id="MathJax-Span-156"><span class="mrow" id="MathJax-Span-157"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.833em, 1000.02em, 4.161em, -1000.02em); top: -2.952em; right: 0em;"><span class="mtd" id="MathJax-Span-215"><span class="mrow" id="MathJax-Span-216"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.833em, 1000.02em, 4.161em, -1000.02em); top: -1.529em; right: 0em;"><span class="mtd" id="MathJax-Span-221"><span class="mrow" id="MathJax-Span-222"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.46em;"></span></span><span style="position: absolute; clip: rect(3.56em, 1027.16em, 9.743em, -1000.02em); top: -6.892em; left: 3.669em;"><span style="display: inline-block; position: relative; width: 27.144em; height: 0px;"><span style="position: absolute; clip: rect(2.958em, 1027.16em, 4.435em, -1000.02em); top: -6.29em; left: 0em;"><span class="mtd" id="MathJax-Span-95"><span class="mrow" id="MathJax-Span-96"><span class="mi" id="MathJax-Span-97"></span><span class="mo" id="MathJax-Span-98" style="font-family: MathJax_Main; padding-left: 0.276em;">=</span><span class="mi" id="MathJax-Span-99" style="font-family: MathJax_Math-italic; padding-left: 0.276em;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-100"><span style="display: inline-block; position: relative; width: 4.545em; height: 0px;"><span style="position: absolute; clip: rect(3.122em, 1003.3em, 4.38em, -1000.02em); top: -3.992em; left: 0em;"><span class="mstyle" id="MathJax-Span-101"><span class="mrow" id="MathJax-Span-102"><span class="mtext" id="MathJax-Span-103" style="font-family: MathJax_Main;">avg loss</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.773em; left: 3.341em;"><span class="texatom" id="MathJax-Span-104"><span class="mrow" id="MathJax-Span-105"><span class="mi" id="MathJax-Span-106" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-107" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-108" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-109" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mo" id="MathJax-Span-110" style="font-family: MathJax_Main; padding-left: 0.222em;">(</span><span class="mn" id="MathJax-Span-111" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-112" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-113" style="font-family: MathJax_Math-italic; padding-left: 0.222em;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-114" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-115"><span style="display: inline-block; position: relative; width: 0.605em; height: 0px;"><span style="position: absolute; clip: rect(3.122em, 1000.29em, 4.161em, -1000.02em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-116" style="font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.276em;"><span class="texatom" id="MathJax-Span-117"><span class="mrow" id="MathJax-Span-118"><span class="mi" id="MathJax-Span-119" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-120" style="font-family: MathJax_Main; padding-left: 0.276em;">=</span><span class="msubsup" id="MathJax-Span-121" style="padding-left: 0.276em;"><span style="display: inline-block; position: relative; width: 1.042em; height: 0px;"><span style="position: absolute; clip: rect(3.122em, 1000.57em, 4.38em, -1000.02em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-122" style="font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.43em; left: 0.605em;"><span class="texatom" id="MathJax-Span-123"><span class="mrow" id="MathJax-Span-124"><span class="mn" id="MathJax-Span-125" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-126"><span style="display: inline-block; position: relative; width: 4.545em; height: 0px;"><span style="position: absolute; clip: rect(3.122em, 1003.3em, 4.38em, -1000.02em); top: -3.992em; left: 0em;"><span class="mstyle" id="MathJax-Span-127"><span class="mrow" id="MathJax-Span-128"><span class="mtext" id="MathJax-Span-129" style="font-family: MathJax_Main;">avg loss</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.773em; left: 3.341em;"><span class="texatom" id="MathJax-Span-130"><span class="mrow" id="MathJax-Span-131"><span class="mi" id="MathJax-Span-132" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-133" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-134" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-135" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-136" style="font-family: MathJax_Math-italic; padding-left: 0.222em;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-137" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-138" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-139" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-140" style="font-family: MathJax_Math-italic; padding-left: 0.222em;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-141" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-142"><span style="display: inline-block; position: relative; width: 1.535em; height: 0px;"><span style="position: absolute; clip: rect(3.122em, 1000.29em, 4.161em, -1000.02em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-143" style="font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.276em;"><span class="texatom" id="MathJax-Span-144"><span class="mrow" id="MathJax-Span-145"><span class="mi" id="MathJax-Span-146" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-147" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-148" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-149" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-150" style="font-family: MathJax_Math-italic; padding-left: 0.222em;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-151"><span style="display: inline-block; position: relative; width: 0.605em; height: 0px;"><span style="position: absolute; clip: rect(3.122em, 1000.29em, 4.161em, -1000.02em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-152" style="font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.276em;"><span class="texatom" id="MathJax-Span-153"><span class="mrow" id="MathJax-Span-154"><span class="mi" id="MathJax-Span-155" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(2.958em, 1022.62em, 4.435em, -1000.02em); top: -4.813em; left: 0em;"><span class="mtd" id="MathJax-Span-158"><span class="mrow" id="MathJax-Span-159"><span class="mi" id="MathJax-Span-160"></span><span class="mo" id="MathJax-Span-161" style="font-family: MathJax_Main; padding-left: 0.276em;">=</span><span class="msubsup" id="MathJax-Span-162" style="padding-left: 0.276em;"><span style="display: inline-block; position: relative; width: 1.042em; height: 0px;"><span style="position: absolute; clip: rect(3.122em, 1000.57em, 4.38em, -1000.02em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-163" style="font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.43em; left: 0.605em;"><span class="texatom" id="MathJax-Span-164"><span class="mrow" id="MathJax-Span-165"><span class="mn" id="MathJax-Span-166" style="font-size: 70.7%; font-family: MathJax_Main;">3</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-167"><span style="display: inline-block; position: relative; width: 4.545em; height: 0px;"><span style="position: absolute; clip: rect(3.122em, 1003.3em, 4.38em, -1000.02em); top: -3.992em; left: 0em;"><span class="mstyle" id="MathJax-Span-168"><span class="mrow" id="MathJax-Span-169"><span class="mtext" id="MathJax-Span-170" style="font-family: MathJax_Main;">avg loss</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.773em; left: 3.341em;"><span class="texatom" id="MathJax-Span-171"><span class="mrow" id="MathJax-Span-172"><span class="mi" id="MathJax-Span-173" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-174" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-175" style="font-size: 70.7%; font-family: MathJax_Main;">3</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-176" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-177" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.042em; height: 0px;"><span style="position: absolute; clip: rect(3.122em, 1000.57em, 4.38em, -1000.02em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-178" style="font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.43em; left: 0.605em;"><span class="texatom" id="MathJax-Span-179"><span class="mrow" id="MathJax-Span-180"><span class="mn" id="MathJax-Span-181" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-182" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-183" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-184" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-185" style="font-family: MathJax_Math-italic; padding-left: 0.222em;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-186" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-187"><span style="display: inline-block; position: relative; width: 1.535em; height: 0px;"><span style="position: absolute; clip: rect(3.122em, 1000.29em, 4.161em, -1000.02em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-188" style="font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.276em;"><span class="texatom" id="MathJax-Span-189"><span class="mrow" id="MathJax-Span-190"><span class="mi" id="MathJax-Span-191" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-192" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-193" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-194" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-195" style="font-family: MathJax_Math-italic; padding-left: 0.222em;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-196" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-197" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-198" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-199" style="font-family: MathJax_Math-italic; padding-left: 0.222em;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-200" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-201"><span style="display: inline-block; position: relative; width: 1.535em; height: 0px;"><span style="position: absolute; clip: rect(3.122em, 1000.29em, 4.161em, -1000.02em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-202" style="font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.276em;"><span class="texatom" id="MathJax-Span-203"><span class="mrow" id="MathJax-Span-204"><span class="mi" id="MathJax-Span-205" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-206" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-207" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-208" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-209" style="font-family: MathJax_Math-italic; padding-left: 0.222em;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-210"><span style="display: inline-block; position: relative; width: 0.605em; height: 0px;"><span style="position: absolute; clip: rect(3.122em, 1000.29em, 4.161em, -1000.02em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-211" style="font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.276em;"><span class="texatom" id="MathJax-Span-212"><span class="mrow" id="MathJax-Span-213"><span class="mi" id="MathJax-Span-214" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(2.52em, 1000.18em, 4.216em, -1000.02em); top: -2.952em; left: 0em;"><span class="mtd" id="MathJax-Span-217"><span class="mrow" id="MathJax-Span-218"><span class="mi" id="MathJax-Span-219"></span><span class="mo" id="MathJax-Span-220" style="font-family: MathJax_Main;">⋮</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(2.958em, 1026.62em, 4.435em, -1000.02em); top: -1.529em; left: 0em;"><span class="mtd" id="MathJax-Span-223"><span class="mrow" id="MathJax-Span-224"><span class="mi" id="MathJax-Span-225"></span><span class="mo" id="MathJax-Span-226" style="font-family: MathJax_Main; padding-left: 0.276em;">=</span><span class="mo" id="MathJax-Span-227" style="font-family: MathJax_Main; padding-left: 0.276em;">(</span><span class="mn" id="MathJax-Span-228" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-229" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-230" style="font-family: MathJax_Math-italic; padding-left: 0.222em;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-231" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-232"><span style="display: inline-block; position: relative; width: 0.933em; height: 0px;"><span style="position: absolute; clip: rect(3.122em, 1000.57em, 4.38em, -1000.02em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-233" style="font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.43em; left: 0.605em;"><span class="texatom" id="MathJax-Span-234"><span class="mrow" id="MathJax-Span-235"><span class="mi" id="MathJax-Span-236" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-237"><span style="display: inline-block; position: relative; width: 0.714em; height: 0px;"><span style="position: absolute; clip: rect(3.122em, 1000.29em, 4.161em, -1000.02em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-238" style="font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.276em;"><span class="texatom" id="MathJax-Span-239"><span class="mrow" id="MathJax-Span-240"><span class="mn" id="MathJax-Span-241" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-242" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mo" id="MathJax-Span-243" style="font-family: MathJax_Main; padding-left: 0.222em;">(</span><span class="mn" id="MathJax-Span-244" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-245" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-246" style="font-family: MathJax_Math-italic; padding-left: 0.222em;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-247" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-248"><span style="display: inline-block; position: relative; width: 1.863em; height: 0px;"><span style="position: absolute; clip: rect(3.122em, 1000.57em, 4.38em, -1000.02em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-249" style="font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.43em; left: 0.605em;"><span class="texatom" id="MathJax-Span-250"><span class="mrow" id="MathJax-Span-251"><span class="mi" id="MathJax-Span-252" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-253" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-254" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-255"><span style="display: inline-block; position: relative; width: 0.714em; height: 0px;"><span style="position: absolute; clip: rect(3.122em, 1000.29em, 4.161em, -1000.02em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-256" style="font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.276em;"><span class="texatom" id="MathJax-Span-257"><span class="mrow" id="MathJax-Span-258"><span class="mn" id="MathJax-Span-259" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-260" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mo" id="MathJax-Span-261" style="font-family: MathJax_Main; padding-left: 0.222em;">⋯</span><span class="mo" id="MathJax-Span-262" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mo" id="MathJax-Span-263" style="font-family: MathJax_Main; padding-left: 0.222em;">(</span><span class="mn" id="MathJax-Span-264" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-265" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-266" style="font-family: MathJax_Math-italic; padding-left: 0.222em;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-267" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-268" style="font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-269"><span style="display: inline-block; position: relative; width: 1.535em; height: 0px;"><span style="position: absolute; clip: rect(3.122em, 1000.29em, 4.161em, -1000.02em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-270" style="font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.276em;"><span class="texatom" id="MathJax-Span-271"><span class="mrow" id="MathJax-Span-272"><span class="mi" id="MathJax-Span-273" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-274" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-275" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-276" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mo" id="MathJax-Span-277" style="font-family: MathJax_Main; padding-left: 0.222em;">(</span><span class="mn" id="MathJax-Span-278" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-279" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-280" style="font-family: MathJax_Math-italic; padding-left: 0.222em;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-281" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-282"><span style="display: inline-block; position: relative; width: 0.605em; height: 0px;"><span style="position: absolute; clip: rect(3.122em, 1000.29em, 4.161em, -1000.02em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-283" style="font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.276em;"><span class="texatom" id="MathJax-Span-284"><span class="mrow" id="MathJax-Span-285"><span class="mi" id="MathJax-Span-286" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.898em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.246em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -3.061em; border-left: 0px solid; width: 0px; height: 6.745em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><msub><mstyle displaystyle="false" scriptlevel="0"><mtext>avg loss</mtext></mstyle><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub></mtd><mtd><mi></mi><mo>=</mo><mi>β</mi><msub><mstyle displaystyle="false" scriptlevel="0"><mtext>avg loss</mtext></mstyle><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>β</mi><mo stretchy="false">)</mo><msub><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub><mo>=</mo><msup><mi>β</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msup><msub><mstyle displaystyle="false" scriptlevel="0"><mtext>avg loss</mtext></mstyle><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>2</mn></mrow></msub><mo>+</mo><mi>β</mi><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>β</mi><mo stretchy="false">)</mo><msub><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>β</mi><msub><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><msup><mi>β</mi><mrow class="MJX-TeXAtom-ORD"><mn>3</mn></mrow></msup><msub><mstyle displaystyle="false" scriptlevel="0"><mtext>avg loss</mtext></mstyle><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>3</mn></mrow></msub><mo>+</mo><msup><mi>β</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msup><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>β</mi><mo stretchy="false">)</mo><msub><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>2</mn></mrow></msub><mo>+</mo><mi>β</mi><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>β</mi><mo stretchy="false">)</mo><msub><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>β</mi><msub><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>⋮</mo></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>β</mi><mo stretchy="false">)</mo><msup><mi>β</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msup><msub><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow></msub><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>β</mi><mo stretchy="false">)</mo><msup><mi>β</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msup><msub><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><mo>+</mo><mo>⋯</mo><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>β</mi><mo stretchy="false">)</mo><mi>β</mi><msub><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>β</mi><mo stretchy="false">)</mo><msub><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-10">\begin{align*}
\hbox{avg loss}_{i} &= \beta \hbox{avg loss}_{i-1} + (1-\beta) l_{i} = \beta^{2} \hbox{avg loss}_{i-2} + \beta(1-\beta) l_{i-1} +  \beta l_{i} \\
&= \beta^{3} \hbox{avg loss}_{i-3} + \beta^{2}(1-\beta) l_{i-2} + \beta(1-\beta) l_{i-1} +  \beta l_{i} \\
&\vdots \\
&= (1-\beta) \beta^{i} l_{0} + (1-\beta) \beta^{i-1} l_{1} + \cdots + (1-\beta) \beta l_{i-1} + (1-\beta) l_{i}
\end{align*}</script>
</div>
<p>so the weights are all powers of <span class="math"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-287" style="width: 0.605em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.55em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.371em, 1000.57em, 2.629em, -1000.02em); top: -2.241em; left: 0em;"><span class="mrow" id="MathJax-Span-288"><span class="mi" id="MathJax-Span-289" style="font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.246em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.303em; border-left: 0px solid; width: 0px; height: 1.106em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>β</mi></math></span></span><script type="math/tex" id="MathJax-Element-11">\beta</script></span>. If remember the formula giving the sum of a geometric sequence, the sum of our weights is</p>
<div class="math">
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo&gt;&amp;#x22EF;&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-290" style="width: 40.168em; display: inline-block;"><span style="display: inline-block; position: relative; width: 35.845em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(0.55em, 1035.86em, 3.286em, -1000.02em); top: -2.241em; left: 0em;"><span class="mrow" id="MathJax-Span-291"><span class="mo" id="MathJax-Span-292" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-293" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-294" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-295" style="font-family: MathJax_Math-italic; padding-left: 0.222em;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-296" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-297"><span style="display: inline-block; position: relative; width: 0.933em; height: 0px;"><span style="position: absolute; clip: rect(3.122em, 1000.57em, 4.38em, -1000.02em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-298" style="font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.43em; left: 0.605em;"><span class="texatom" id="MathJax-Span-299"><span class="mrow" id="MathJax-Span-300"><span class="mi" id="MathJax-Span-301" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-302" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mo" id="MathJax-Span-303" style="font-family: MathJax_Main; padding-left: 0.222em;">(</span><span class="mn" id="MathJax-Span-304" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-305" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-306" style="font-family: MathJax_Math-italic; padding-left: 0.222em;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-307" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-308"><span style="display: inline-block; position: relative; width: 1.863em; height: 0px;"><span style="position: absolute; clip: rect(3.122em, 1000.57em, 4.38em, -1000.02em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-309" style="font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.43em; left: 0.605em;"><span class="texatom" id="MathJax-Span-310"><span class="mrow" id="MathJax-Span-311"><span class="mi" id="MathJax-Span-312" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-313" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-314" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-315" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mo" id="MathJax-Span-316" style="font-family: MathJax_Main; padding-left: 0.222em;">⋯</span><span class="mo" id="MathJax-Span-317" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mo" id="MathJax-Span-318" style="font-family: MathJax_Main; padding-left: 0.222em;">(</span><span class="mn" id="MathJax-Span-319" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-320" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-321" style="font-family: MathJax_Math-italic; padding-left: 0.222em;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-322" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-323" style="font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-324" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mo" id="MathJax-Span-325" style="font-family: MathJax_Main; padding-left: 0.222em;">(</span><span class="mn" id="MathJax-Span-326" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-327" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-328" style="font-family: MathJax_Math-italic; padding-left: 0.222em;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-329" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-330" style="font-family: MathJax_Main; padding-left: 0.276em;">=</span><span class="mo" id="MathJax-Span-331" style="font-family: MathJax_Main; padding-left: 0.276em;">(</span><span class="mn" id="MathJax-Span-332" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-333" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-334" style="font-family: MathJax_Math-italic; padding-left: 0.222em;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-335" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-336" style="font-family: MathJax_Main; padding-left: 0.222em;">∗</span><span class="mfrac" id="MathJax-Span-337" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 3.669em; height: 0px; margin-right: 0.112em; margin-left: 0.112em;"><span style="position: absolute; clip: rect(3.012em, 1003.58em, 4.38em, -1000.02em); top: -4.649em; left: 50%; margin-left: -1.803em;"><span class="mrow" id="MathJax-Span-338"><span class="mn" id="MathJax-Span-339" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-340" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-341" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.863em; height: 0px;"><span style="position: absolute; clip: rect(3.122em, 1000.57em, 4.38em, -1000.02em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-342" style="font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.375em; left: 0.605em;"><span class="texatom" id="MathJax-Span-343"><span class="mrow" id="MathJax-Span-344"><span class="mi" id="MathJax-Span-345" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-346" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-347" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.122em, 1002.32em, 4.38em, -1000.02em); top: -3.28em; left: 50%; margin-left: -1.146em;"><span class="mrow" id="MathJax-Span-348"><span class="mn" id="MathJax-Span-349" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-350" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-351" style="font-family: MathJax_Math-italic; padding-left: 0.222em;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.878em, 1003.69em, 1.261em, -1000.02em); top: -1.311em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.669em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.097em;"></span></span></span></span><span class="mo" id="MathJax-Span-352" style="font-family: MathJax_Main; padding-left: 0.276em;">=</span><span class="mn" id="MathJax-Span-353" style="font-family: MathJax_Main; padding-left: 0.276em;">1</span><span class="mo" id="MathJax-Span-354" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-355" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.863em; height: 0px;"><span style="position: absolute; clip: rect(3.122em, 1000.57em, 4.38em, -1000.02em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-356" style="font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.43em; left: 0.605em;"><span class="texatom" id="MathJax-Span-357"><span class="mrow" id="MathJax-Span-358"><span class="mi" id="MathJax-Span-359" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-360" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-361" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.246em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.039em; border-left: 0px solid; width: 0px; height: 2.822em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>β</mi><mo stretchy="false">)</mo><msup><mi>β</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msup><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>β</mi><mo stretchy="false">)</mo><msup><mi>β</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>+</mo><mo>⋯</mo><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>β</mi><mo stretchy="false">)</mo><mi>β</mi><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>β</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>β</mi><mo stretchy="false">)</mo><mo>∗</mo><mfrac><mrow><mn>1</mn><mo>−</mo><msup><mi>β</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msup></mrow><mrow><mn>1</mn><mo>−</mo><mi>β</mi></mrow></mfrac><mo>=</mo><mn>1</mn><mo>−</mo><msup><mi>β</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msup></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-12">\begin{equation*}
(1-\beta) \beta^{i} + (1-\beta) \beta^{i-1} + \cdots + (1-\beta) \beta + (1-\beta) = (1-\beta) * \frac{1-\beta^{i+1}}{1-\beta} = 1-\beta^{i+1}
\end{equation*}</script>
</div>
<p>so to really be an average, we have to divide our average loss by this factor. In the end, the loss we will plot is</p>
<div class="math">
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;&gt;&lt;mtext&gt;smoothed loss&lt;/mtext&gt;&lt;/mstyle&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;msub&gt;&lt;mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;&gt;&lt;mtext&gt;avg loss&lt;/mtext&gt;&lt;/mstyle&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-362" style="width: 13.355em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.932em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(0.659em, 1011.84em, 3.341em, -1000.02em); top: -2.241em; left: 0em;"><span class="mrow" id="MathJax-Span-363"><span class="msubsup" id="MathJax-Span-364"><span style="display: inline-block; position: relative; width: 6.296em; height: 0px;"><span style="position: absolute; clip: rect(3.122em, 1005.93em, 4.161em, -1000.02em); top: -3.992em; left: 0em;"><span class="mstyle" id="MathJax-Span-365"><span class="mrow" id="MathJax-Span-366"><span class="mtext" id="MathJax-Span-367" style="font-family: MathJax_Main;">smoothed loss</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.828em; left: 5.967em;"><span class="texatom" id="MathJax-Span-368"><span class="mrow" id="MathJax-Span-369"><span class="mi" id="MathJax-Span-370" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-371" style="font-family: MathJax_Main; padding-left: 0.276em;">=</span><span class="mfrac" id="MathJax-Span-372" style="padding-left: 0.276em;"><span style="display: inline-block; position: relative; width: 3.778em; height: 0px; margin-right: 0.112em; margin-left: 0.112em;"><span style="position: absolute; clip: rect(3.122em, 1003.69em, 4.435em, -1000.02em); top: -4.703em; left: 50%; margin-left: -1.803em;"><span class="msubsup" id="MathJax-Span-373"><span style="display: inline-block; position: relative; width: 3.669em; height: 0px;"><span style="position: absolute; clip: rect(3.122em, 1003.3em, 4.38em, -1000.02em); top: -3.992em; left: 0em;"><span class="mstyle" id="MathJax-Span-374"><span class="mrow" id="MathJax-Span-375"><span class="mtext" id="MathJax-Span-376" style="font-family: MathJax_Main;">avg loss</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.773em; left: 3.341em;"><span class="texatom" id="MathJax-Span-377"><span class="mrow" id="MathJax-Span-378"><span class="mi" id="MathJax-Span-379" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.067em, 1003.58em, 4.38em, -1000.02em); top: -3.28em; left: 50%; margin-left: -1.803em;"><span class="mrow" id="MathJax-Span-380"><span class="mn" id="MathJax-Span-381" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-382" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-383" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.863em; height: 0px;"><span style="position: absolute; clip: rect(3.122em, 1000.57em, 4.38em, -1000.02em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-384" style="font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.265em; left: 0.605em;"><span class="texatom" id="MathJax-Span-385"><span class="mrow" id="MathJax-Span-386"><span class="mi" id="MathJax-Span-387" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-388" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-389" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.878em, 1003.8em, 1.261em, -1000.02em); top: -1.311em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.778em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.097em;"></span></span></span></span><span class="mo" id="MathJax-Span-390" style="font-family: MathJax_Main;">.</span></span><span style="display: inline-block; width: 0px; height: 2.246em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.1em; border-left: 0px solid; width: 0px; height: 2.761em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mstyle displaystyle="false" scriptlevel="0"><mtext>smoothed loss</mtext></mstyle><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub><mo>=</mo><mfrac><msub><mstyle displaystyle="false" scriptlevel="0"><mtext>avg loss</mtext></mstyle><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub><mrow><mn>1</mn><mo>−</mo><msup><mi>β</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msup></mrow></mfrac><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-13">\begin{equation*}
\hbox{smoothed loss}_{i} = \frac{\hbox{avg loss}_{i}}{1-\beta^{i+1}}.
\end{equation*}</script>
</div>
<p>This doesn't really change a thing when <span class="math"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-391" style="width: 0.386em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.331em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.425em, 1000.29em, 2.41em, -1000.02em); top: -2.241em; left: 0em;"><span class="mrow" id="MathJax-Span-392"><span class="mi" id="MathJax-Span-393" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.246em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.058em; border-left: 0px solid; width: 0px; height: 0.861em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-14">i</script></span> is big, because <span class="math"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-394" style="width: 2.082em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.863em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.261em, 1001.88em, 2.629em, -1000.02em); top: -2.241em; left: 0em;"><span class="mrow" id="MathJax-Span-395"><span class="msubsup" id="MathJax-Span-396"><span style="display: inline-block; position: relative; width: 1.863em; height: 0px;"><span style="position: absolute; clip: rect(3.122em, 1000.57em, 4.38em, -1000.02em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-397" style="font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.375em; left: 0.605em;"><span class="texatom" id="MathJax-Span-398"><span class="mrow" id="MathJax-Span-399"><span class="mi" id="MathJax-Span-400" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-401" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-402" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.246em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.303em; border-left: 0px solid; width: 0px; height: 1.29em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>β</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-15">\beta^{i+1}</script></span> will be very close to 0. But for the first values of <span class="math"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-403" style="width: 0.386em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.331em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.425em, 1000.29em, 2.41em, -1000.02em); top: -2.241em; left: 0em;"><span class="mrow" id="MathJax-Span-404"><span class="mi" id="MathJax-Span-405" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.246em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.058em; border-left: 0px solid; width: 0px; height: 0.861em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-16">i</script></span>, it insures we get better
results. This is called the bias-corrected version of our average.</p>
<p>The next thing we will change in our training loop is that we probably won't need to do one whole epoch: if the loss is starting to explode, we probably don't want to continue.
The criteria that's implemented in the fastai library and that seems to work pretty well is:</p>
<div class="math">
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;&gt;&lt;mtext&gt;current smoothed loss&lt;/mtext&gt;&lt;/mstyle&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;&gt;&lt;mtext&gt;minimum smoothed loss&lt;/mtext&gt;&lt;/mstyle&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-406" style="width: 25.612em; display: inline-block;"><span style="display: inline-block; position: relative; width: 22.876em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.371em, 1022.84em, 2.465em, -1000.02em); top: -2.241em; left: 0em;"><span class="mrow" id="MathJax-Span-407"><span class="mstyle" id="MathJax-Span-408"><span class="mrow" id="MathJax-Span-409"><span class="mtext" id="MathJax-Span-410" style="font-family: MathJax_Main;">current smoothed loss</span></span></span><span class="mo" id="MathJax-Span-411" style="font-family: MathJax_Main; padding-left: 0.276em;">&gt;</span><span class="mn" id="MathJax-Span-412" style="font-family: MathJax_Main; padding-left: 0.276em;">4</span><span class="mo" id="MathJax-Span-413" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="mstyle" id="MathJax-Span-414" style="padding-left: 0.222em;"><span class="mrow" id="MathJax-Span-415"><span class="mtext" id="MathJax-Span-416" style="font-family: MathJax_Main;">minimum smoothed loss</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.246em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.12em; border-left: 0px solid; width: 0px; height: 0.922em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mstyle displaystyle="false" scriptlevel="0"><mtext>current smoothed loss</mtext></mstyle><mo>&gt;</mo><mn>4</mn><mo>×</mo><mstyle displaystyle="false" scriptlevel="0"><mtext>minimum smoothed loss</mtext></mstyle></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-17">\begin{equation*}
\hbox{current smoothed loss} > 4 \times \hbox{minimum smoothed loss}
\end{equation*}</script>
</div>
<p>Lastly, we need just a tiny bit of math to figure out by how much to multiply our learning rate at each step. If we begin with a learning rate of <span class="math"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;&gt;&lt;mtext&gt;lr&lt;/mtext&gt;&lt;/mstyle&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-417" style="width: 1.261em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.097em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.371em, 1001.12em, 2.575em, -1000.02em); top: -2.241em; left: 0em;"><span class="mrow" id="MathJax-Span-418"><span class="msubsup" id="MathJax-Span-419"><span style="display: inline-block; position: relative; width: 1.097em; height: 0px;"><span style="position: absolute; clip: rect(3.122em, 1000.62em, 4.161em, -1000.02em); top: -3.992em; left: 0em;"><span class="mstyle" id="MathJax-Span-420"><span class="mrow" id="MathJax-Span-421"><span class="mtext" id="MathJax-Span-422" style="font-family: MathJax_Main;">lr</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.659em;"><span class="texatom" id="MathJax-Span-423"><span class="mrow" id="MathJax-Span-424"><span class="mn" id="MathJax-Span-425" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.246em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.242em; border-left: 0px solid; width: 0px; height: 1.106em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mstyle displaystyle="false" scriptlevel="0"><mtext>lr</mtext></mstyle><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-18">\hbox{lr}_{0}</script></span> and
multiply it at each step by <span class="math"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-426" style="width: 0.495em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.441em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.644em, 1000.46em, 2.629em, -1000.02em); top: -2.241em; left: 0em;"><span class="mrow" id="MathJax-Span-427"><span class="mi" id="MathJax-Span-428" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.246em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.303em; border-left: 0px solid; width: 0px; height: 0.861em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-19">q</script></span> then at the <span class="math"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-429" style="width: 0.386em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.331em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.425em, 1000.29em, 2.41em, -1000.02em); top: -2.241em; left: 0em;"><span class="mrow" id="MathJax-Span-430"><span class="mi" id="MathJax-Span-431" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.246em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.058em; border-left: 0px solid; width: 0px; height: 0.861em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-20">i</script></span>-th step, our learning rate will be</p>
<div class="math">
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;&gt;&lt;mtext&gt;lr&lt;/mtext&gt;&lt;/mstyle&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;&gt;&lt;mtext&gt;lr&lt;/mtext&gt;&lt;/mstyle&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-432" style="width: 6.131em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.475em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.207em, 1005.49em, 2.629em, -1000.02em); top: -2.241em; left: 0em;"><span class="mrow" id="MathJax-Span-433"><span class="msubsup" id="MathJax-Span-434"><span style="display: inline-block; position: relative; width: 0.988em; height: 0px;"><span style="position: absolute; clip: rect(3.122em, 1000.62em, 4.161em, -1000.02em); top: -3.992em; left: 0em;"><span class="mstyle" id="MathJax-Span-435"><span class="mrow" id="MathJax-Span-436"><span class="mtext" id="MathJax-Span-437" style="font-family: MathJax_Main;">lr</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.659em;"><span class="texatom" id="MathJax-Span-438"><span class="mrow" id="MathJax-Span-439"><span class="mi" id="MathJax-Span-440" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-441" style="font-family: MathJax_Main; padding-left: 0.276em;">=</span><span class="msubsup" id="MathJax-Span-442" style="padding-left: 0.276em;"><span style="display: inline-block; position: relative; width: 1.097em; height: 0px;"><span style="position: absolute; clip: rect(3.122em, 1000.62em, 4.161em, -1000.02em); top: -3.992em; left: 0em;"><span class="mstyle" id="MathJax-Span-443"><span class="mrow" id="MathJax-Span-444"><span class="mtext" id="MathJax-Span-445" style="font-family: MathJax_Main;">lr</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.659em;"><span class="texatom" id="MathJax-Span-446"><span class="mrow" id="MathJax-Span-447"><span class="mn" id="MathJax-Span-448" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-449" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="msubsup" id="MathJax-Span-450" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.824em; height: 0px;"><span style="position: absolute; clip: rect(3.395em, 1000.46em, 4.38em, -1000.02em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-451" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.43em; left: 0.495em;"><span class="texatom" id="MathJax-Span-452"><span class="mrow" id="MathJax-Span-453"><span class="mi" id="MathJax-Span-454" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.246em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.303em; border-left: 0px solid; width: 0px; height: 1.351em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mstyle displaystyle="false" scriptlevel="0"><mtext>lr</mtext></mstyle><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub><mo>=</mo><msub><mstyle displaystyle="false" scriptlevel="0"><mtext>lr</mtext></mstyle><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow></msub><mo>×</mo><msup><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msup></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-21">\begin{equation*}
\hbox{lr}_{i} = \hbox{lr}_{0} \times q^{i}
\end{equation*}</script>
</div>
<p>Now, we want to figure out <span class="math"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-455" style="width: 0.495em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.441em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.644em, 1000.46em, 2.629em, -1000.02em); top: -2.241em; left: 0em;"><span class="mrow" id="MathJax-Span-456"><span class="mi" id="MathJax-Span-457" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.246em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.303em; border-left: 0px solid; width: 0px; height: 0.861em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-22">q</script></span> knowing <span class="math"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;&gt;&lt;mtext&gt;lr&lt;/mtext&gt;&lt;/mstyle&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-458" style="width: 1.261em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.097em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.371em, 1001.12em, 2.575em, -1000.02em); top: -2.241em; left: 0em;"><span class="mrow" id="MathJax-Span-459"><span class="msubsup" id="MathJax-Span-460"><span style="display: inline-block; position: relative; width: 1.097em; height: 0px;"><span style="position: absolute; clip: rect(3.122em, 1000.62em, 4.161em, -1000.02em); top: -3.992em; left: 0em;"><span class="mstyle" id="MathJax-Span-461"><span class="mrow" id="MathJax-Span-462"><span class="mtext" id="MathJax-Span-463" style="font-family: MathJax_Main;">lr</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.659em;"><span class="texatom" id="MathJax-Span-464"><span class="mrow" id="MathJax-Span-465"><span class="mn" id="MathJax-Span-466" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.246em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.242em; border-left: 0px solid; width: 0px; height: 1.106em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mstyle displaystyle="false" scriptlevel="0"><mtext>lr</mtext></mstyle><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-23">\hbox{lr}_{0}</script></span> and <span class="math"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;&gt;&lt;mtext&gt;lr&lt;/mtext&gt;&lt;/mstyle&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-467" style="width: 2.575em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.301em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.371em, 1002.32em, 2.629em, -1000.02em); top: -2.241em; left: 0em;"><span class="mrow" id="MathJax-Span-468"><span class="msubsup" id="MathJax-Span-469"><span style="display: inline-block; position: relative; width: 2.301em; height: 0px;"><span style="position: absolute; clip: rect(3.122em, 1000.62em, 4.161em, -1000.02em); top: -3.992em; left: 0em;"><span class="mstyle" id="MathJax-Span-470"><span class="mrow" id="MathJax-Span-471"><span class="mtext" id="MathJax-Span-472" style="font-family: MathJax_Main;">lr</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.659em;"><span class="texatom" id="MathJax-Span-473"><span class="mrow" id="MathJax-Span-474"><span class="mi" id="MathJax-Span-475" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-476" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-477" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.246em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.303em; border-left: 0px solid; width: 0px; height: 1.106em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mstyle displaystyle="false" scriptlevel="0"><mtext>lr</mtext></mstyle><mrow class="MJX-TeXAtom-ORD"><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-24">\hbox{lr}_{N-1}</script></span> (the final value after <span class="math"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-478" style="width: 1.042em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.933em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.425em, 1000.95em, 2.41em, -1000.02em); top: -2.241em; left: 0em;"><span class="mrow" id="MathJax-Span-479"><span class="mi" id="MathJax-Span-480" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.112em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.246em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.058em; border-left: 0px solid; width: 0px; height: 0.861em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-25">N</script></span> steps) so we isolate it:</p>
<div class="math">
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;&gt;&lt;mtext&gt;lr&lt;/mtext&gt;&lt;/mstyle&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;&gt;&lt;mtext&gt;lr&lt;/mtext&gt;&lt;/mstyle&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mspace width=&quot;1em&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x27FA;&lt;/mo&gt;&lt;mspace width=&quot;1em&quot; /&gt;&lt;msup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;msub&gt;&lt;mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;&gt;&lt;mtext&gt;lr&lt;/mtext&gt;&lt;/mstyle&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;&gt;&lt;mtext&gt;lr&lt;/mtext&gt;&lt;/mstyle&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mfrac&gt;&lt;mspace width=&quot;1em&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x27FA;&lt;/mo&gt;&lt;mspace width=&quot;1em&quot; /&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mfrac&gt;&lt;msub&gt;&lt;mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;&gt;&lt;mtext&gt;lr&lt;/mtext&gt;&lt;/mstyle&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;&gt;&lt;mtext&gt;lr&lt;/mtext&gt;&lt;/mstyle&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mfrac&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-481" style="width: 34.039em; display: inline-block;"><span style="display: inline-block; position: relative; width: 30.373em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(0.222em, 1030.39em, 3.341em, -1000.02em); top: -2.241em; left: 0em;"><span class="mrow" id="MathJax-Span-482"><span class="msubsup" id="MathJax-Span-483"><span style="display: inline-block; position: relative; width: 2.301em; height: 0px;"><span style="position: absolute; clip: rect(3.122em, 1000.62em, 4.161em, -1000.02em); top: -3.992em; left: 0em;"><span class="mstyle" id="MathJax-Span-484"><span class="mrow" id="MathJax-Span-485"><span class="mtext" id="MathJax-Span-486" style="font-family: MathJax_Main;">lr</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.659em;"><span class="texatom" id="MathJax-Span-487"><span class="mrow" id="MathJax-Span-488"><span class="mi" id="MathJax-Span-489" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-490" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-491" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-492" style="font-family: MathJax_Main; padding-left: 0.276em;">=</span><span class="msubsup" id="MathJax-Span-493" style="padding-left: 0.276em;"><span style="display: inline-block; position: relative; width: 1.097em; height: 0px;"><span style="position: absolute; clip: rect(3.122em, 1000.62em, 4.161em, -1000.02em); top: -3.992em; left: 0em;"><span class="mstyle" id="MathJax-Span-494"><span class="mrow" id="MathJax-Span-495"><span class="mtext" id="MathJax-Span-496" style="font-family: MathJax_Main;">lr</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.659em;"><span class="texatom" id="MathJax-Span-497"><span class="mrow" id="MathJax-Span-498"><span class="mn" id="MathJax-Span-499" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-500" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="msubsup" id="MathJax-Span-501" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 2.137em; height: 0px;"><span style="position: absolute; clip: rect(3.395em, 1000.46em, 4.38em, -1000.02em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-502" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.43em; left: 0.495em;"><span class="texatom" id="MathJax-Span-503"><span class="mrow" id="MathJax-Span-504"><span class="mi" id="MathJax-Span-505" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-506" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-507" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mspace" id="MathJax-Span-508" style="height: 0em; vertical-align: 0em; width: 0.988em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-509" style="font-family: MathJax_Main; padding-left: 0.276em;">⟺</span><span class="mspace" id="MathJax-Span-510" style="height: 0em; vertical-align: 0em; width: 0.988em; display: inline-block; overflow: hidden;"></span><span class="msubsup" id="MathJax-Span-511" style="padding-left: 0.276em;"><span style="display: inline-block; position: relative; width: 2.137em; height: 0px;"><span style="position: absolute; clip: rect(3.395em, 1000.46em, 4.38em, -1000.02em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-512" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.43em; left: 0.495em;"><span class="texatom" id="MathJax-Span-513"><span class="mrow" id="MathJax-Span-514"><span class="mi" id="MathJax-Span-515" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-516" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-517" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-518" style="font-family: MathJax_Main; padding-left: 0.276em;">=</span><span class="mfrac" id="MathJax-Span-519" style="padding-left: 0.276em;"><span style="display: inline-block; position: relative; width: 2.41em; height: 0px; margin-right: 0.112em; margin-left: 0.112em;"><span style="position: absolute; clip: rect(3.122em, 1002.26em, 4.38em, -1000.02em); top: -4.703em; left: 50%; margin-left: -1.146em;"><span class="msubsup" id="MathJax-Span-520"><span style="display: inline-block; position: relative; width: 2.301em; height: 0px;"><span style="position: absolute; clip: rect(3.122em, 1000.62em, 4.161em, -1000.02em); top: -3.992em; left: 0em;"><span class="mstyle" id="MathJax-Span-521"><span class="mrow" id="MathJax-Span-522"><span class="mtext" id="MathJax-Span-523" style="font-family: MathJax_Main;">lr</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.659em;"><span class="texatom" id="MathJax-Span-524"><span class="mrow" id="MathJax-Span-525"><span class="mi" id="MathJax-Span-526" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-527" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-528" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.122em, 1001.12em, 4.326em, -1000.02em); top: -3.28em; left: 50%; margin-left: -0.544em;"><span class="msubsup" id="MathJax-Span-529"><span style="display: inline-block; position: relative; width: 1.097em; height: 0px;"><span style="position: absolute; clip: rect(3.122em, 1000.62em, 4.161em, -1000.02em); top: -3.992em; left: 0em;"><span class="mstyle" id="MathJax-Span-530"><span class="mrow" id="MathJax-Span-531"><span class="mtext" id="MathJax-Span-532" style="font-family: MathJax_Main;">lr</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.659em;"><span class="texatom" id="MathJax-Span-533"><span class="mrow" id="MathJax-Span-534"><span class="mn" id="MathJax-Span-535" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.878em, 1002.37em, 1.261em, -1000.02em); top: -1.311em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.41em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.097em;"></span></span></span></span><span class="mspace" id="MathJax-Span-536" style="height: 0em; vertical-align: 0em; width: 0.988em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-537" style="font-family: MathJax_Main; padding-left: 0.276em;">⟺</span><span class="mspace" id="MathJax-Span-538" style="height: 0em; vertical-align: 0em; width: 0.988em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-539" style="font-family: MathJax_Math-italic; padding-left: 0.276em;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-540" style="font-family: MathJax_Main; padding-left: 0.276em;">=</span><span class="msubsup" id="MathJax-Span-541" style="padding-left: 0.276em;"><span style="display: inline-block; position: relative; width: 5.639em; height: 0px;"><span style="position: absolute; clip: rect(2.41em, 1003.91em, 5.092em, -1000.02em); top: -3.992em; left: 0em;"><span class="mrow" id="MathJax-Span-542"><span class="mo" id="MathJax-Span-543" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span><span class="mfrac" id="MathJax-Span-544"><span style="display: inline-block; position: relative; width: 2.41em; height: 0px; margin-right: 0.112em; margin-left: 0.112em;"><span style="position: absolute; clip: rect(3.122em, 1002.26em, 4.38em, -1000.02em); top: -4.703em; left: 50%; margin-left: -1.146em;"><span class="msubsup" id="MathJax-Span-545"><span style="display: inline-block; position: relative; width: 2.301em; height: 0px;"><span style="position: absolute; clip: rect(3.122em, 1000.62em, 4.161em, -1000.02em); top: -3.992em; left: 0em;"><span class="mstyle" id="MathJax-Span-546"><span class="mrow" id="MathJax-Span-547"><span class="mtext" id="MathJax-Span-548" style="font-family: MathJax_Main;">lr</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.659em;"><span class="texatom" id="MathJax-Span-549"><span class="mrow" id="MathJax-Span-550"><span class="mi" id="MathJax-Span-551" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-552" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-553" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.122em, 1001.12em, 4.326em, -1000.02em); top: -3.28em; left: 50%; margin-left: -0.544em;"><span class="msubsup" id="MathJax-Span-554"><span style="display: inline-block; position: relative; width: 1.097em; height: 0px;"><span style="position: absolute; clip: rect(3.122em, 1000.62em, 4.161em, -1000.02em); top: -3.992em; left: 0em;"><span class="mstyle" id="MathJax-Span-555"><span class="mrow" id="MathJax-Span-556"><span class="mtext" id="MathJax-Span-557" style="font-family: MathJax_Main;">lr</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.659em;"><span class="texatom" id="MathJax-Span-558"><span class="mrow" id="MathJax-Span-559"><span class="mn" id="MathJax-Span-560" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.878em, 1002.37em, 1.261em, -1000.02em); top: -1.311em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.41em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.097em;"></span></span></span></span><span class="mo" id="MathJax-Span-561" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -5.141em; left: 4.107em;"><span class="texatom" id="MathJax-Span-562"><span class="mrow" id="MathJax-Span-563"><span class="mfrac" id="MathJax-Span-564"><span style="display: inline-block; position: relative; width: 1.207em; height: 0px; margin-right: 0.112em; margin-left: 0.112em;"><span style="position: absolute; clip: rect(3.505em, 1000.24em, 4.161em, -1000.02em); top: -4.32em; left: 50%; margin-left: -0.107em;"><span class="mn" id="MathJax-Span-565" style="font-size: 50%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.505em, 1001.06em, 4.216em, -1000.02em); top: -3.664em; left: 50%; margin-left: -0.544em;"><span class="mrow" id="MathJax-Span-566"><span class="mi" id="MathJax-Span-567" style="font-size: 50%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-568" style="font-size: 50%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-569" style="font-size: 50%; font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.878em, 1001.23em, 1.261em, -1000.02em); top: -1.256em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.207em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.097em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.246em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.1em; border-left: 0px solid; width: 0px; height: 3.251em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mstyle displaystyle="false" scriptlevel="0"><mtext>lr</mtext></mstyle><mrow class="MJX-TeXAtom-ORD"><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mstyle displaystyle="false" scriptlevel="0"><mtext>lr</mtext></mstyle><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow></msub><mo>×</mo><msup><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msup><mspace width="1em"></mspace><mo stretchy="false">⟺</mo><mspace width="1em"></mspace><msup><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>=</mo><mfrac><msub><mstyle displaystyle="false" scriptlevel="0"><mtext>lr</mtext></mstyle><mrow class="MJX-TeXAtom-ORD"><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msub><msub><mstyle displaystyle="false" scriptlevel="0"><mtext>lr</mtext></mstyle><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow></msub></mfrac><mspace width="1em"></mspace><mo stretchy="false">⟺</mo><mspace width="1em"></mspace><mi>q</mi><mo>=</mo><msup><mrow><mo>(</mo><mfrac><msub><mstyle displaystyle="false" scriptlevel="0"><mtext>lr</mtext></mstyle><mrow class="MJX-TeXAtom-ORD"><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msub><msub><mstyle displaystyle="false" scriptlevel="0"><mtext>lr</mtext></mstyle><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow></msub></mfrac><mo>)</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mfrac><mn>1</mn><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></mfrac></mrow></msup></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-26">\begin{equation*}
\hbox{lr}_{N-1} = \hbox{lr}_{0} \times q^{N-1} \quad \Longleftrightarrow \quad q^{N-1} = \frac{\hbox{lr}_{N-1}}{\hbox{lr}_{0}} \quad \Longleftrightarrow \quad q = \left ( \frac{\hbox{lr}_{N-1}}{\hbox{lr}_{0}}  \right )^{\frac{1}{N-1}}
\end{equation*}</script>
</div>
<p>Why go through this trouble and not just take learning rates by regularly splitting the interval between our initial value and our final value? We have to remember we will
plot the loss against the logs of the learning rates at the end, and if we take the log of our <span class="math"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;&gt;&lt;mtext&gt;lr&lt;/mtext&gt;&lt;/mstyle&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-570" style="width: 1.097em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.988em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.371em, 1001.01em, 2.575em, -1000.02em); top: -2.241em; left: 0em;"><span class="mrow" id="MathJax-Span-571"><span class="msubsup" id="MathJax-Span-572"><span style="display: inline-block; position: relative; width: 0.988em; height: 0px;"><span style="position: absolute; clip: rect(3.122em, 1000.62em, 4.161em, -1000.02em); top: -3.992em; left: 0em;"><span class="mstyle" id="MathJax-Span-573"><span class="mrow" id="MathJax-Span-574"><span class="mtext" id="MathJax-Span-575" style="font-family: MathJax_Main;">lr</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.659em;"><span class="texatom" id="MathJax-Span-576"><span class="mrow" id="MathJax-Span-577"><span class="mi" id="MathJax-Span-578" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.246em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.242em; border-left: 0px solid; width: 0px; height: 1.106em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mstyle displaystyle="false" scriptlevel="0"><mtext>lr</mtext></mstyle><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-27">\hbox{lr}_{i}</script></span> we have</p>
<div class="math">
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;&gt;&lt;mtext&gt;lr&lt;/mtext&gt;&lt;/mstyle&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;&gt;&lt;mtext&gt;lr&lt;/mtext&gt;&lt;/mstyle&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;&gt;&lt;mtext&gt;lr&lt;/mtext&gt;&lt;/mstyle&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;&gt;&lt;mtext&gt;lr&lt;/mtext&gt;&lt;/mstyle&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;&gt;&lt;mtext&gt;lr&lt;/mtext&gt;&lt;/mstyle&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-579" style="width: 30.427em; display: inline-block;"><span style="display: inline-block; position: relative; width: 27.144em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(0.605em, 1027.05em, 3.177em, -1000.02em); top: -2.241em; left: 0em;"><span class="mrow" id="MathJax-Span-580"><span class="mi" id="MathJax-Span-581" style="font-family: MathJax_Main;">log</span><span class="mo" id="MathJax-Span-582"></span><span class="mo" id="MathJax-Span-583" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-584"><span style="display: inline-block; position: relative; width: 0.988em; height: 0px;"><span style="position: absolute; clip: rect(3.122em, 1000.62em, 4.161em, -1000.02em); top: -3.992em; left: 0em;"><span class="mstyle" id="MathJax-Span-585"><span class="mrow" id="MathJax-Span-586"><span class="mtext" id="MathJax-Span-587" style="font-family: MathJax_Main;">lr</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.659em;"><span class="texatom" id="MathJax-Span-588"><span class="mrow" id="MathJax-Span-589"><span class="mi" id="MathJax-Span-590" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-591" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-592" style="font-family: MathJax_Main; padding-left: 0.276em;">=</span><span class="mi" id="MathJax-Span-593" style="font-family: MathJax_Main; padding-left: 0.276em;">log</span><span class="mo" id="MathJax-Span-594"></span><span class="mo" id="MathJax-Span-595" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-596"><span style="display: inline-block; position: relative; width: 1.097em; height: 0px;"><span style="position: absolute; clip: rect(3.122em, 1000.62em, 4.161em, -1000.02em); top: -3.992em; left: 0em;"><span class="mstyle" id="MathJax-Span-597"><span class="mrow" id="MathJax-Span-598"><span class="mtext" id="MathJax-Span-599" style="font-family: MathJax_Main;">lr</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.659em;"><span class="texatom" id="MathJax-Span-600"><span class="mrow" id="MathJax-Span-601"><span class="mn" id="MathJax-Span-602" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-603" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-604" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-605" style="font-family: MathJax_Math-italic; padding-left: 0.222em;">i</span><span class="mi" id="MathJax-Span-606" style="font-family: MathJax_Main; padding-left: 0.167em;">log</span><span class="mo" id="MathJax-Span-607"></span><span class="mo" id="MathJax-Span-608" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-609" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-610" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-611" style="font-family: MathJax_Main; padding-left: 0.276em;">=</span><span class="mi" id="MathJax-Span-612" style="font-family: MathJax_Main; padding-left: 0.276em;">log</span><span class="mo" id="MathJax-Span-613"></span><span class="mo" id="MathJax-Span-614" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-615"><span style="display: inline-block; position: relative; width: 1.097em; height: 0px;"><span style="position: absolute; clip: rect(3.122em, 1000.62em, 4.161em, -1000.02em); top: -3.992em; left: 0em;"><span class="mstyle" id="MathJax-Span-616"><span class="mrow" id="MathJax-Span-617"><span class="mtext" id="MathJax-Span-618" style="font-family: MathJax_Main;">lr</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.659em;"><span class="texatom" id="MathJax-Span-619"><span class="mrow" id="MathJax-Span-620"><span class="mn" id="MathJax-Span-621" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-622" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-623" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-624" style="font-family: MathJax_Math-italic; padding-left: 0.222em;">i</span><span class="mfrac" id="MathJax-Span-625"><span style="display: inline-block; position: relative; width: 8.813em; height: 0px; margin-right: 0.112em; margin-left: 0.112em;"><span style="position: absolute; clip: rect(3.067em, 1008.61em, 4.435em, -1000.02em); top: -4.703em; left: 50%; margin-left: -4.375em;"><span class="mrow" id="MathJax-Span-626"><span class="mi" id="MathJax-Span-627" style="font-family: MathJax_Main;">log</span><span class="mo" id="MathJax-Span-628"></span><span class="mo" id="MathJax-Span-629" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-630"><span style="display: inline-block; position: relative; width: 2.301em; height: 0px;"><span style="position: absolute; clip: rect(3.122em, 1000.62em, 4.161em, -1000.02em); top: -3.992em; left: 0em;"><span class="mstyle" id="MathJax-Span-631"><span class="mrow" id="MathJax-Span-632"><span class="mtext" id="MathJax-Span-633" style="font-family: MathJax_Main;">lr</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.659em;"><span class="texatom" id="MathJax-Span-634"><span class="mrow" id="MathJax-Span-635"><span class="mi" id="MathJax-Span-636" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-637" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-638" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-639" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-640" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-641" style="font-family: MathJax_Main; padding-left: 0.222em;">log</span><span class="mo" id="MathJax-Span-642"></span><span class="mo" id="MathJax-Span-643" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-644"><span style="display: inline-block; position: relative; width: 1.097em; height: 0px;"><span style="position: absolute; clip: rect(3.122em, 1000.62em, 4.161em, -1000.02em); top: -3.992em; left: 0em;"><span class="mstyle" id="MathJax-Span-645"><span class="mrow" id="MathJax-Span-646"><span class="mtext" id="MathJax-Span-647" style="font-family: MathJax_Main;">lr</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.659em;"><span class="texatom" id="MathJax-Span-648"><span class="mrow" id="MathJax-Span-649"><span class="mn" id="MathJax-Span-650" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-651" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.177em, 1002.54em, 4.216em, -1000.02em); top: -3.28em; left: 50%; margin-left: -1.311em;"><span class="mrow" id="MathJax-Span-652"><span class="mi" id="MathJax-Span-653" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.112em;"></span></span><span class="mo" id="MathJax-Span-654" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mn" id="MathJax-Span-655" style="font-family: MathJax_Main; padding-left: 0.222em;">1</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.878em, 1008.83em, 1.261em, -1000.02em); top: -1.311em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 8.813em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.097em;"></span></span></span></span><span class="mo" id="MathJax-Span-656" style="font-family: MathJax_Main;">,</span></span><span style="display: inline-block; width: 0px; height: 2.246em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.916em; border-left: 0px solid; width: 0px; height: 2.638em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mstyle displaystyle="false" scriptlevel="0"><mtext>lr</mtext></mstyle><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub><mo stretchy="false">)</mo><mo>=</mo><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mstyle displaystyle="false" scriptlevel="0"><mtext>lr</mtext></mstyle><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow></msub><mo stretchy="false">)</mo><mo>+</mo><mi>i</mi><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo><mo>=</mo><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mstyle displaystyle="false" scriptlevel="0"><mtext>lr</mtext></mstyle><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow></msub><mo stretchy="false">)</mo><mo>+</mo><mi>i</mi><mfrac><mrow><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mstyle displaystyle="false" scriptlevel="0"><mtext>lr</mtext></mstyle><mrow class="MJX-TeXAtom-ORD"><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo>−</mo><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mstyle displaystyle="false" scriptlevel="0"><mtext>lr</mtext></mstyle><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow></msub><mo stretchy="false">)</mo></mrow><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></mfrac><mo>,</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-28">\begin{equation*}
\log(\hbox{lr}_{i}) = \log(\hbox{lr}_{0}) + i \log(q) = \log(\hbox{lr}_{0}) + i\frac{\log(\hbox{lr}_{N-1}) - \log(\hbox{lr}_{0})}{N-1},
\end{equation*}</script>
</div>
<p>which corresponds to regularly splitting the interval between our initial value and our final value... but on a log scale! That way we're sure to have evenly spaced points on our
curve, whereas by taking</p>
<div class="math">
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;&gt;&lt;mtext&gt;lr&lt;/mtext&gt;&lt;/mstyle&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;&gt;&lt;mtext&gt;lr&lt;/mtext&gt;&lt;/mstyle&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;&gt;&lt;mtext&gt;lr&lt;/mtext&gt;&lt;/mstyle&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;&gt;&lt;mtext&gt;lr&lt;/mtext&gt;&lt;/mstyle&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-657" style="width: 11.111em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.907em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(0.714em, 1009.92em, 3.177em, -1000.02em); top: -2.241em; left: 0em;"><span class="mrow" id="MathJax-Span-658"><span class="msubsup" id="MathJax-Span-659"><span style="display: inline-block; position: relative; width: 0.988em; height: 0px;"><span style="position: absolute; clip: rect(3.122em, 1000.62em, 4.161em, -1000.02em); top: -3.992em; left: 0em;"><span class="mstyle" id="MathJax-Span-660"><span class="mrow" id="MathJax-Span-661"><span class="mtext" id="MathJax-Span-662" style="font-family: MathJax_Main;">lr</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.659em;"><span class="texatom" id="MathJax-Span-663"><span class="mrow" id="MathJax-Span-664"><span class="mi" id="MathJax-Span-665" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-666" style="font-family: MathJax_Main; padding-left: 0.276em;">=</span><span class="msubsup" id="MathJax-Span-667" style="padding-left: 0.276em;"><span style="display: inline-block; position: relative; width: 1.097em; height: 0px;"><span style="position: absolute; clip: rect(3.122em, 1000.62em, 4.161em, -1000.02em); top: -3.992em; left: 0em;"><span class="mstyle" id="MathJax-Span-668"><span class="mrow" id="MathJax-Span-669"><span class="mtext" id="MathJax-Span-670" style="font-family: MathJax_Main;">lr</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.659em;"><span class="texatom" id="MathJax-Span-671"><span class="mrow" id="MathJax-Span-672"><span class="mn" id="MathJax-Span-673" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-674" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-675" style="font-family: MathJax_Math-italic; padding-left: 0.222em;">i</span><span class="mfrac" id="MathJax-Span-676"><span style="display: inline-block; position: relative; width: 4.709em; height: 0px; margin-right: 0.112em; margin-left: 0.112em;"><span style="position: absolute; clip: rect(3.122em, 1004.62em, 4.38em, -1000.02em); top: -4.703em; left: 50%; margin-left: -2.296em;"><span class="mrow" id="MathJax-Span-677"><span class="msubsup" id="MathJax-Span-678"><span style="display: inline-block; position: relative; width: 2.301em; height: 0px;"><span style="position: absolute; clip: rect(3.122em, 1000.62em, 4.161em, -1000.02em); top: -3.992em; left: 0em;"><span class="mstyle" id="MathJax-Span-679"><span class="mrow" id="MathJax-Span-680"><span class="mtext" id="MathJax-Span-681" style="font-family: MathJax_Main;">lr</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.659em;"><span class="texatom" id="MathJax-Span-682"><span class="mrow" id="MathJax-Span-683"><span class="mi" id="MathJax-Span-684" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-685" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-686" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-687" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-688" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.097em; height: 0px;"><span style="position: absolute; clip: rect(3.122em, 1000.62em, 4.161em, -1000.02em); top: -3.992em; left: 0em;"><span class="mstyle" id="MathJax-Span-689"><span class="mrow" id="MathJax-Span-690"><span class="mtext" id="MathJax-Span-691" style="font-family: MathJax_Main;">lr</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.659em;"><span class="texatom" id="MathJax-Span-692"><span class="mrow" id="MathJax-Span-693"><span class="mn" id="MathJax-Span-694" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.177em, 1002.54em, 4.216em, -1000.02em); top: -3.28em; left: 50%; margin-left: -1.311em;"><span class="mrow" id="MathJax-Span-695"><span class="mi" id="MathJax-Span-696" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.112em;"></span></span><span class="mo" id="MathJax-Span-697" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mn" id="MathJax-Span-698" style="font-family: MathJax_Main; padding-left: 0.222em;">1</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.878em, 1004.73em, 1.261em, -1000.02em); top: -1.311em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.709em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.097em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.246em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.916em; border-left: 0px solid; width: 0px; height: 2.516em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mstyle displaystyle="false" scriptlevel="0"><mtext>lr</mtext></mstyle><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub><mo>=</mo><msub><mstyle displaystyle="false" scriptlevel="0"><mtext>lr</mtext></mstyle><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow></msub><mo>+</mo><mi>i</mi><mfrac><mrow><msub><mstyle displaystyle="false" scriptlevel="0"><mtext>lr</mtext></mstyle><mrow class="MJX-TeXAtom-ORD"><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>−</mo><msub><mstyle displaystyle="false" scriptlevel="0"><mtext>lr</mtext></mstyle><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow></msub></mrow><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-29">\begin{equation*}
\hbox{lr}_{i} = \hbox{lr}_{0} + i \frac{\hbox{lr}_{N-1} - \hbox{lr}_{0}}{N-1}
\end{equation*}</script>
</div>
<p>we would have had all the points concentrated near the end (since <span class="math"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;&gt;&lt;mtext&gt;lr&lt;/mtext&gt;&lt;/mstyle&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-699" style="width: 2.575em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.301em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.371em, 1002.32em, 2.629em, -1000.02em); top: -2.241em; left: 0em;"><span class="mrow" id="MathJax-Span-700"><span class="msubsup" id="MathJax-Span-701"><span style="display: inline-block; position: relative; width: 2.301em; height: 0px;"><span style="position: absolute; clip: rect(3.122em, 1000.62em, 4.161em, -1000.02em); top: -3.992em; left: 0em;"><span class="mstyle" id="MathJax-Span-702"><span class="mrow" id="MathJax-Span-703"><span class="mtext" id="MathJax-Span-704" style="font-family: MathJax_Main;">lr</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.659em;"><span class="texatom" id="MathJax-Span-705"><span class="mrow" id="MathJax-Span-706"><span class="mi" id="MathJax-Span-707" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-708" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-709" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.246em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.303em; border-left: 0px solid; width: 0px; height: 1.106em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mstyle displaystyle="false" scriptlevel="0"><mtext>lr</mtext></mstyle><mrow class="MJX-TeXAtom-ORD"><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-30">\hbox{lr}_{N-1}</script></span> is much bigger than <span class="math"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;&gt;&lt;mtext&gt;lr&lt;/mtext&gt;&lt;/mstyle&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-710" style="width: 1.261em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.097em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.371em, 1001.12em, 2.575em, -1000.02em); top: -2.241em; left: 0em;"><span class="mrow" id="MathJax-Span-711"><span class="msubsup" id="MathJax-Span-712"><span style="display: inline-block; position: relative; width: 1.097em; height: 0px;"><span style="position: absolute; clip: rect(3.122em, 1000.62em, 4.161em, -1000.02em); top: -3.992em; left: 0em;"><span class="mstyle" id="MathJax-Span-713"><span class="mrow" id="MathJax-Span-714"><span class="mtext" id="MathJax-Span-715" style="font-family: MathJax_Main;">lr</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.659em;"><span class="texatom" id="MathJax-Span-716"><span class="mrow" id="MathJax-Span-717"><span class="mn" id="MathJax-Span-718" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.246em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.242em; border-left: 0px solid; width: 0px; height: 1.106em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mstyle displaystyle="false" scriptlevel="0"><mtext>lr</mtext></mstyle><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-31">\hbox{lr}_{0}</script></span>).</p>
<p>With all of this, we're ready to alter our previous training loop. This all supposes that you've got a neural net defined (in the variable called net), a data loader called
trn_loader, an optimizer and a loss function (called criterion).</p>
<pre class="code python literal-block"><span class="k">def</span> <span class="nf">find_lr</span><span class="p">(</span><span class="n">init_value</span> <span class="o">=</span> <span class="mf">1e-8</span><span class="p">,</span> <span class="n">final_value</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">beta</span> <span class="o">=</span> <span class="mf">0.98</span><span class="p">):</span>
    <span class="n">num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">trn_loader</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
    <span class="n">mult</span> <span class="o">=</span> <span class="p">(</span><span class="n">final_value</span> <span class="o">/</span> <span class="n">init_value</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">num</span><span class="p">)</span>
    <span class="n">lr</span> <span class="o">=</span> <span class="n">init_value</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">param_groups</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">'lr'</span><span class="p">]</span> <span class="o">=</span> <span class="n">lr</span>
    <span class="n">avg_loss</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="n">best_loss</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="n">batch_num</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">losses</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">log_lrs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">trn_loader</span><span class="p">:</span>
        <span class="n">batch_num</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="c1">#As before, get the loss for this mini-batch of inputs/outputs</span>
        <span class="n">inputs</span><span class="p">,</span><span class="n">labels</span> <span class="o">=</span> <span class="n">data</span>
        <span class="n">inputs</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="n">inputs</span><span class="p">),</span> <span class="n">Variable</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
        <span class="n">outputs</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
        <span class="c1">#Compute the smoothed loss</span>
        <span class="n">avg_loss</span> <span class="o">=</span> <span class="n">beta</span> <span class="o">*</span> <span class="n">avg_loss</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">beta</span><span class="p">)</span> <span class="o">*</span><span class="n">loss</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">smoothed_loss</span> <span class="o">=</span> <span class="n">avg_loss</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">beta</span><span class="o">**</span><span class="n">batch_num</span><span class="p">)</span>
        <span class="c1">#Stop if the loss is exploding</span>
        <span class="k">if</span> <span class="n">batch_num</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">smoothed_loss</span> <span class="o">&gt;</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">best_loss</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">log_lrs</span><span class="p">,</span> <span class="n">losses</span>
        <span class="c1">#Record the best loss</span>
        <span class="k">if</span> <span class="n">smoothed_loss</span> <span class="o">&lt;</span> <span class="n">best_loss</span> <span class="ow">or</span> <span class="n">batch_num</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">best_loss</span> <span class="o">=</span> <span class="n">smoothed_loss</span>
        <span class="c1">#Store the values</span>
        <span class="n">losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">smoothed_loss</span><span class="p">)</span>
        <span class="n">log_lrs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">lr</span><span class="p">))</span>
        <span class="c1">#Do the SGD step</span>
        <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
        <span class="c1">#Update the lr for the next step</span>
        <span class="n">lr</span> <span class="o">*=</span> <span class="n">mult</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">param_groups</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">'lr'</span><span class="p">]</span> <span class="o">=</span> <span class="n">lr</span>
    <span class="k">return</span> <span class="n">log_lrs</span><span class="p">,</span> <span class="n">losses</span>
</pre>
<p>Note that the learning rate is found into the dictionary stored in optimizer.param_groups. If we go back to our notebook with the MNIST data set, we can then define our
neural net, an optimizer and the loss function.</p>
<pre class="code python literal-block"><span class="n">net</span> <span class="o">=</span> <span class="n">SimpleNeuralNet</span><span class="p">(</span><span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span><span class="n">lr</span><span class="o">=</span><span class="mf">1e-1</span><span class="p">)</span>
<span class="n">criterion</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">nll_loss</span>
</pre>
<p>And after this we can call this function to find our learning rate and plot the results.</p>
<pre class="code python literal-block"><span class="n">logs</span><span class="p">,</span><span class="n">losses</span> <span class="o">=</span> <span class="n">find_lr</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">logs</span><span class="p">[</span><span class="mi">10</span><span class="p">:</span><span class="o">-</span><span class="mi">5</span><span class="p">],</span><span class="n">losses</span><span class="p">[</span><span class="mi">10</span><span class="p">:</span><span class="o">-</span><span class="mi">5</span><span class="p">])</span>
</pre>
<p>The skip of the first 10 values and the last 5 is another thing that the fastai library does by default, to remove the initial and final high losses and focus on the interesting
parts of the graph. I added all of this at the end of the previous notebook, and you can find it <a class="reference external" href="https://github.com/sgugger/Deep-Learning/blob/master/Learning%20rate%20finder.ipynb">here</a>.</p>
<p>This code modifies the neural net and its optimizer, so we have to be careful to reinitialize those after doing this, to the best value we can. An amelioration to the code
would be to save it then reload the initial state when we're done (which is what the fastai library does).</p>
</div>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="https://sgugger.github.io/tag/sgd.html">SGD</a>
      <a href="https://sgugger.github.io/tag/learning-rate.html">Learning Rate</a>
    </p>
  </div>




</article>

    <footer>
<p>© Sylvain Gugger 2018</p>
<p>    Powered by <a href="http://getpelican.com/" target="_blank">Pelican</a> - <a href="https://github.com/alexandrevicenzi/flex" target="_blank">Flex</a> theme by <a href="http://alexandrevicenzi.com/" target="_blank">Alexandre Vicenzi</a>
</p>    </footer>
  </main><script id="mathjaxscript_pelican_#%@#$@#" type="text/javascript" src="./Another data science student&#39;s blog – How Do You Find A Good Learning Rate_files/MathJax.js">MathJax.Hub.Config({    config: ['MMLorHTML.js'],    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },    jax: ['input/TeX','input/MathML','output/HTML-CSS'],    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],    displayAlign: 'center',    displayIndent: '0em',    showMathMenu: true,    messageStyle: 'normal',    tex2jax: {         inlineMath: [ ['\\(','\\)'] ],         displayMath: [ ['$$','$$'] ],        processEscapes: true,        preview: 'TeX',    },     'HTML-CSS': {         styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} },        linebreaks: { automatic: false, width: '90% container' },    }, }); if ('default' !== 'default') {MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;VARIANT['normal'].fonts.unshift('MathJax_default');VARIANT['bold'].fonts.unshift('MathJax_default-bold');VARIANT['italic'].fonts.unshift('MathJax_default-italic');VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');});MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;VARIANT['normal'].fonts.unshift('MathJax_default');VARIANT['bold'].fonts.unshift('MathJax_default-bold');VARIANT['italic'].fonts.unshift('MathJax_default-italic');VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');});}</script>





<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Another data science student's blog ",
  "url" : "",
  "image": "/images/profile.png",
  "description": ""
}
</script>

<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: MathJax_Size3, sans-serif;"></div></div></body></html>